<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<title>📜 自定义标题栏 CustomTkinterTitlebar | CustomTkinterTitlebar</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="📜 自定义标题栏 CustomTkinterTitlebar" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="这是一个📚项目可以帮助你拥有一个📑自定义的标题栏！📦小组件可以被🗄放到这个标题栏里面！This is a 📚project can help you to have a 📑custom titlebar! 📦Component can 🗄add into titlebar~" />
<meta property="og:description" content="这是一个📚项目可以帮助你拥有一个📑自定义的标题栏！📦小组件可以被🗄放到这个标题栏里面！This is a 📚project can help you to have a 📑custom titlebar! 📦Component can 🗄add into titlebar~" />
<link rel="canonical" href="https://littlewhitecloud.github.io/CustomTkinterTitlebar/" />
<meta property="og:url" content="https://littlewhitecloud.github.io/CustomTkinterTitlebar/" />
<meta property="og:site_name" content="CustomTkinterTitlebar" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="📜 自定义标题栏 CustomTkinterTitlebar" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","description":"这是一个📚项目可以帮助你拥有一个📑自定义的标题栏！📦小组件可以被🗄放到这个标题栏里面！This is a 📚project can help you to have a 📑custom titlebar! 📦Component can 🗄add into titlebar~","headline":"📜 自定义标题栏 CustomTkinterTitlebar","name":"CustomTkinterTitlebar","url":"https://littlewhitecloud.github.io/CustomTkinterTitlebar/"}</script>

    <link rel="stylesheet" href="/CustomTkinterTitlebar/assets/css/style.css?v=c3b17538a3c32bd475d7387b2363024e7fdeadc9">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="https://github.com/littlewhitecloud/CustomTkinterTitlebar/">CustomTkinterTitlebar</a></h1>

      <h1 id="-自定义标题栏-customtkintertitlebar-">📜 <em>自定义标题栏 CustomTkinterTitlebar</em> <img src="https://img.shields.io/badge/Python-3.11.1-blue.svg?color=#0c63ba" alt="Python 3.11.1" /></h1>
<h5 id="include-english--chinese-language--包括英文与中文语言">📖Include <strong>English</strong> &amp; <strong>Chinese</strong> language 📜 包括英文与中文语言</h5>
<h4 id="-本程序还在预览中可能会有许多bug-this-project-is-still-in-preview-there-may-be-many-bugs">⚠ 本程序还在预览中，可能会有许多bug! This project is still in preview, there may be many bugs!</h4>
<h3 id="-感谢每个看我的项目的人thank-for-everyone-who-looked-at-my-project">😉 感谢每个看我的项目的人！Thank for everyone who looked at my project!</h3>
<h6 id="更希望给我颗星-hope-got-some-stars"><em>更希望给我颗星~</em> <em>Hope got some stars~</em></h6>
<h3 id="-这是一个项目可以帮助你拥有一个自定义的标题栏小组件可以被放到这个标题栏里面this-is-a-project-can-help-you-to-have-a-custom-titlebar-widgets-can-add-into-titlebar">📃 <em>这是一个项目可以帮助你拥有一个自定义的标题栏！小组件可以被放到这个标题栏里面！(This is a project can help you to have a custom titlebar! Widgets can add into titlebar!)</em></h3>
<h4 id="-_关于更多这个项目我写了一篇文章在bilibili上它很详细的说了这个项目-more-about-this-project-i-wrote-an-article-on-bilibili-which-talks-about-this-project-in-more-detail-_-httpswwwbilibilicomreadcv20558473">❔ _关于更多这个项目，我写了一篇文章在Bilibili上，它很详细的说了这个项目 (More about this project, I wrote an article on Bilibili, which talks about this project in more detail: _ https://www.bilibili.com/read/cv20558473</h4>
<blockquote>
  <p>文章其实在下面 (有删改)</p>
  <h3 id="预览-view-">预览 (View) :</h3>
  <p>https://user-images.githubusercontent.com/71159641/209435938-fb962481-f655-4b6a-97ed-faa295eabcd9.mp4</p>
  <h4 id="自定义最大化最小化-custom-minsize--maxsize">自定义最大化最小化 (Custom minsize &amp; maxsize)：</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/209454983-ba0baa31-9c07-45be-8dff-47da76bf1dbf.png" alt="image" />
<img src="https://user-images.githubusercontent.com/71159641/209454984-e3698f89-9d0d-4be1-8af3-1ca78c1068dc.png" alt="image" />
<img src="https://user-images.githubusercontent.com/71159641/209454985-7d725083-dbcb-4856-88e4-200a34111938.png" alt="image" />
<img src="https://user-images.githubusercontent.com/71159641/209455001-f48c076a-cac0-4310-975e-0fb64855f4cd.png" alt="image" /></p>
  <h4 id="自定义图标和名称-icon--windowtext">自定义图标和名称 (icon &amp; windowtext):</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/209605935-e82470ce-e0d2-4244-9299-dbcf666c7e6b.png" alt="image" />
<img src="https://user-images.githubusercontent.com/71159641/209605940-c9c58cd9-6ff3-4455-9f7f-229611a67cda.png" alt="image" />
<img src="https://user-images.githubusercontent.com/71159641/209605941-d38732dd-1917-42e0-985a-eba98e21494b.png" alt="image" /></p>
  <h4 id="模糊-blur">模糊 (Blur):</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/209063710-fa11556b-ca04-41db-a6d4-29b6ed3ce329.png" alt="image" /></p>
  <h4 id="亚克力-fluent-">亚克力 (Fluent) :</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/208341143-b9d01ff0-c530-414c-be5d-38be9f55949b.png" alt="image" /></p>
  <h4 id="插入组件-insert-component-to-titlebar-">插入组件 (insert component to titlebar) :</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/208231899-c25fa950-57f7-4a90-8095-cceadbf6d371.png" alt="image" /></p>
  <h4 id="聚焦-focus-on-">聚焦 (Focus on) :</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/208881100-3ab06ae8-f51c-459d-8d2b-8a90a6218078.png" alt="image" /></p>
  <h4 id="未聚焦-focus-out-">未聚焦 (Focus out) :</h4>
  <p><img src="https://user-images.githubusercontent.com/71159641/208881104-8606a9fc-1a1e-432b-980d-16e7c7581acc.png" alt="image" /></p>
</blockquote>

<h3 id="-需求-require">📦 需求 (Require):</h3>
<blockquote>
  <ul>
    <li><em>Windows 10</em></li>
    <li><em>Python &gt;= 3.8.0</em></li>
    <li><em>Pillow &gt;= 9.0.0</em></li>
    <li><em>darkdetect &gt;= 0.8.0</em></li>
    <li><em>BlurWindow &gt;= 1.2.1</em>
      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -m pip install --upgrade pip
pip install pillow --user
</code></pre></div>      </div>
    </li>
  </ul>
</blockquote>

<h3 id="-用法-usage">📖 用法 (Usage):</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from customtkintertitlebar import Tk
from tkinter import ttk
example = Tk()
example.title("TitleBar")
example.geometry("1030x570")
en = ttk.Entry(example.titlebar)
en.pack(fill = Y, expand = True, ipadx = 30, pady = 5)
example.mainloop()
</code></pre></div></div>

<h3 id="-问题-bug">🐞 问题 (Bug):</h3>
<h4 id="我无法修复从外面导入custompy时发生的图片找不到的错误-图片路径错误"><em>我无法修复从外面导入custom.py时，发生的图片找不到的错误 (图片路径错误）</em></h4>
<blockquote>
  <p>I can’t fix the image not found error that occurs when importing custom.py from outside (wrong picture path)</p>
</blockquote>

<h3 id="-未来添加-future-additions">✨ 未来添加 (Future additions):</h3>
<blockquote>
  <ul class="task-list">
    <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><em>亮主题时的最大化最小化和关闭按钮 Maximize minimize and close buttons when the theme is light</em></li>
    <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" /><em>调整窗口大小 Resize the window</em></li>
  </ul>
</blockquote>

<h3 id="-更新update">🧊 更新(Update):</h3>
<h4 id="none">None</h4>

<h3 id="-支持-support">💾 支持 (Support):</h3>
<h4 id="-它现在支持windows-10">💻 它现在支持Windows 10</h4>
<blockquote>
  <p><strong>可能也支持Windows 11, 我用的是Windows 10, 未测试过</strong></p>
  <h4 id="it-support-windows-10-now">It support Windows 10 now.</h4>
  <p><strong>Maybe it also support Windows 11, I am using Windows 10, I didn’t test this project on Windows 11 yet</strong></p>
</blockquote>

<h2 id="the-doc-doesnt-support-english-now-i-will-try-to-translate-it">The doc doesn’t support English now. I will try to translate it.</h2>
<h3 id="文章">文章：</h3>
<h4 id="整个事情的大概">整个事情的大概：</h4>
<blockquote>
  <p><em>一个月前，我就看到有许多自定义标题栏的样例，我很羡慕。
于是我就在想，tkinter能不能做到呢，于是，在我一个月以前就开始挖坑了……
直到这一个月，我才开始去填这个坑，因为终于到了周末嘛，我把作业在周五晚上都刷完了，并且也没什么事情，闲来无事，找到了遗弃下来的这个坑，于是就开始填了……</em></p>
  <h4 id="想法">想法：</h4>
  <p>先 <strong>overrideredirect</strong> 窗口，<em>使窗口失去标题栏&amp;边框以及后面很麻烦的任务栏上的图标</em>。
然后创建一个 <em>Frame 设置图标，文本，最大化，最小化，关闭按钮~</em>
最后在随便完善一下，就好了。</p>
  <h3 id="理论好像存在实践有很多问题">理论好像存在，实践有很多问题。</h3>
  <h4 id="细节">细节：</h4>
  <ul>
    <li>把鼠标放在三个按钮之上的时候或显示50%透明的按钮</li>
    <li>双击标题栏会 最大化 / 最小化</li>
    <li>右键图标会有功能菜单</li>
    <li>增加 <em>Acrylic Blur</em></li>
    <li>可拖动标题栏移动窗口</li>
    <li>可以放置任何组件 <strong>（Menu 不可以）</strong> 在标题栏内</li>
  </ul>
</blockquote>

<p>开发时遇到的问题：</p>
<blockquote>
  <p>1.如何最小化</p>
  <blockquote>
    <ul>
      <li>直接最小化会出问题</li>
      <li>奇葩的解决办法：
        <blockquote>
          <p>先取消overrideredirect，在最小化就好了：</p>
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  def minsize(self):
      self.overrideredirect(False)
      self.o_flag = False # 待会再讲 o_flag什么意义
      self.state("iconic")
</code></pre></div>          </div>
          <p>2.最小化后再打开</p>
        </blockquote>
      </li>
      <li>会出现原标题栏</li>
      <li>解决方案：
        <blockquote>
          <ul>
            <li>先检查state 是不是”iconic”, 如果是，并且o_flag是假的时候执行overrideredirect</li>
            <li>o_flag(overrideredirect_flag): 窗口是否被overrideredirect
```
def check(self):
    if self.state() != “iconic” and self.o_flag == False:
        self.overrideredirect(True)
        self.o_flag = True</li>
          </ul>
        </blockquote>
      </li>
    </ul>
  </blockquote>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	self.after(500, self.check) #每500秒刷新一次 如果你的电脑性能高的话，可以改成 100 ``` &gt; 3.如何移动： ```
def Dragging(self, event):
	global x, y
	x = event.x
	y = event.y

def Stopping(self, event):
	x = None
	y = None

def Moving(self, event):
	global x, y
	deltax = event.x - x
	deltay = event.y - y
	self.geometry("+%s+%s" % (self.winfo_x() + deltax, self.winfo_y() + deltay))
	self.update() ``` &gt; 4.最大化 &gt;&gt; 直接“暴力”点： &gt;&gt;&gt; self.state("zoomed")
</code></pre></div></div>

<h4 id="现存的bug">现存的BUG：</h4>
<blockquote>
  <ul>
    <li>#1 这个版本只能使用黑暗模式，还没做光亮模式</li>
    <li>#2 双击标题栏最大化后，最大化图标会出现问题</li>
    <li>#3 全屏会“全屏”</li>
    <li>#4 当有菜单的时候，菜单会在标题栏上方（推测，目前还没有试过）</li>
  </ul>
</blockquote>

<h4 id="修改">修改：</h4>
<h5 id="20221217-153559">2022/12/17 15:35:59</h5>
<blockquote>
  <ul>
    <li>不想做浅色时最大化最小化和关闭的图标了</li>
    <li>#2 &amp; #3 解决  + 新产生的 #5 无法正确全屏 + 新增窗口focus in（聚焦） 和 focus on（未聚焦） 时的标题栏颜色 + 自动调节主题（darkdetect） + 窗口acrylic模糊（可选，自己修&gt;改）+ 优化：节约self.color[key]调用次数和os.getcwd()调用次数  + 右键窗口图标菜单</li>
    <li>titlebar.pack取消了pady = 1, padx = 1(强迫症福音)</li>
    <li>titleicon.pack由padx = 7, pady = 7, 改为padx = 6, pady = 6尽量和Windows原生标题栏一样大</li>
    <li>color[“light”] &amp; color[“light_nf”] 被改为淡白色#f2efef，而不是淡青色#ececee


<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	
class Tk(Tk):
	def init(self):
		super().init()
		path = getcwd()
	# resources
	self._t0_load = Image.open(path + '\\assets\\close_50.png')
	self._t0_img = ImageTk.PhotoImage(self._t0_load)

	self._t0_hov_load = Image.open(path + '\\assets\\close_100.png')
	self._t0_hov_img = ImageTk.PhotoImage(self._t0_hov_load)

	self._t1_load = Image.open(path + '\\assets\\minisize_50.png')
	self._t1_img = ImageTk.PhotoImage(self._t1_load)

	self._t1_hov_load = Image.open(path + '\\assets\\minisize_100.png')
	self._t1_hov_img = ImageTk.PhotoImage(self._t1_hov_load)

	self._t2_load = Image.open(path + '\\assets\\fullwin_50.png')
	self._t2_img = ImageTk.PhotoImage(self._t2_load)

	self._t2_hov_load = Image.open(path + '\\assets\\fullwin_100.png')
	self._t2_hov_img = ImageTk.PhotoImage(self._t2_hov_load)

	self._t3_load = Image.open(path + '\\assets\\togglefull_50.png')
	self._t3_img = ImageTk.PhotoImage(self._t3_load)

	self._t3_hov_load = Image.open(path + '\\assets\\togglefull_100.png')
	self._t3_hov_img = ImageTk.PhotoImage(self._t3_hov_load)
			
	# flags
	self.w, self.h = 0, 0
	self.o_flag = False
	self.o_m = False
	self.o_f = False
	self.colors = {
		"Light": "#ffffff",
		"Dark": "#2b2b2b",
		"button_activebg": '#262626',
		"button_activefg": '#262626',
		"exit_fg": "#e81123",
		"exit_bg": "#e81123",
		"dark": "#000000",
		"dark_nf": "#2b2b2b",
		"light": "#f2efef",
		"light_nf": "#f2efef",
	}
	self.theme = "light"
	self.bg = self.colors["light"]
	self.nf = self.colors["light_nf"]
	self.fg = "dark"
	
	if isDark():
		self.theme = "dark"
		self.bg = self.colors["dark"]
		self.nf = self.colors["dark_nf"]
		self.fg = "light"
		
	self["background"] = self.colors[self.theme.title()]
	
	# tools
	self.popup = Menu(self, tearoff = 0)
	self.popup.add_command(label = "还原", command = self.resizeback)
	self.popup.entryconfig("还原", state="disabled")
	self.popup.add_command(label = "最小化", command = self.minsize)
	self.popup.add_command(label = "最大化", command = self.maxsize)
	self.popup.add_separator()
	self.popup.add_command(label = "关闭 (Alt+F4)", command = self.destroy)
	
	self.titlebar = Frame(self, bg = self.bg)
	self._titleicon = Label(self.titlebar, bg = self.bg)
	self._titletext = Label(self.titlebar, text = "tk", bg = self.bg, fg = self.colors[self.fg])
	self._titlemin = Button(self.titlebar, bg = self.bg)
	self._titlemax = Button(self.titlebar, bg = self.bg)
	self._titleexit = Button(self.titlebar, bg = self.bg)
	
	self._titleexit.config(bd = 0,
		#bg = colors["exit_fg"],
		activeforeground = self.colors["exit_fg"],
		activebackground = self.colors["exit_bg"],
		width = 44,
		image = self._t0_hov_img,
		relief = 'flat',
		command = self.quit
	)
	self._titlemin.config(bd = 0,
		#bg = colors["exit_fg"],
		activeforeground = self.colors["button_activefg"],
		activebackground = self.bg,
		width = 44,
		image = self._t1_hov_img,
		relief = 'flat',
		command = self.minsize
	)
	self._titlemax.config(bd = 0,
		#bg = colors["exit_fg"],
		activeforeground = self.colors["button_activefg"],
		activebackground = self.bg,
		width = 44,
		image = self._t2_hov_img,
		relief = 'flat',
		command = self.maxsize
	)

	self._titleicon.pack(fill = X, side = LEFT, padx = 6, pady = 6)
	self._titletext.pack(fill = X, side = LEFT, padx = 1, pady = 1)

	self._titleexit.pack(fill = Y, side = RIGHT)
	self._titlemax.pack(fill = Y, side = RIGHT)
	self._titlemin.pack(fill = Y, side = RIGHT)

	self.titlebar.pack(fill = X, side = TOP)
	
	# binds &amp; after
	self.check()
	
	self.bind("&lt;FocusOut&gt;", self.focusout)
	self.bind("&lt;FocusIn&gt;", self.focusin)
	self.bind("&lt;F11&gt;", self.maxsize)

	self._titleexit.bind("&lt;Enter&gt;", self.exit_on_enter)
	self._titleexit.bind("&lt;Leave&gt;", self.exit_on_leave)
	self._titlemin.bind("&lt;Enter&gt;", self.min_on_enter)
	self._titlemin.bind("&lt;Leave&gt;", self.min_on_leave)
	self._titlemax.bind("&lt;Enter&gt;", self.max_on_enter)
	self._titlemax.bind("&lt;Leave&gt;", self.max_on_leave)
	
	self._titleicon.bind("&lt;Button-3&gt;", self.popupmenu)
	self.titlebar.bind("&lt;ButtonPress-1&gt;", self.dragging)
	self.titlebar.bind("&lt;ButtonRelease-1&gt;", self.stopping)
	self.titlebar.bind("&lt;B1-Motion&gt;", self.moving)
	self.titlebar.bind("&lt;Double-Button-1&gt;", self.maxsize)
	
	self.after(100, self.addblur)

def addblur(self):
	hwnd = windll.user32.GetForegroundWindow()
	blur(hwnd = hwnd, Dark = True, Acrylic = True, AccentState = 4) # Custom AccentState

def popupmenu(self, event):
	self.popup.post(event.x_root, event.y_root)

def dragging(self, event):
	global x, y
	x = event.x
	y = event.y

def stopping(self, event):
	x = None
	y = None

def moving(self, event):
	global x, y
	if self.o_m == True:
		self.resizeback()
	else:
		deltax = event.x - x
		deltay = event.y - y
		self.geometry("+%s+%s" % (self.winfo_x() + deltax, self.winfo_y() + deltay))
		self.update()
		
def focusout(self, event):
	if self.theme != "light":
		self.o_f = True
		self.titlebar["bg"] = self.nf
		self._titleicon["bg"] = self.nf
		self._titletext["bg"] = self.nf, 
		self._titlemin["bg"] = self.nf
		self._titlemax["bg"] = self.nf
		self._titleexit["bg"] = self.nf

def focusin(self, event):
	if self.theme != "light":
		self.o_f = False
		self.titlebar["bg"] = self.bg
		self._titleicon["bg"] = self.bg
		self._titletext["bg"] = self.bg
		self._titlemin["bg"] = self.bg
		self._titlemax["bg"] = self.bg
		self._titleexit["bg"] = self.bg

def resizeback(self):
	#self.state("normal")
	self.popup.entryconfig("还原", state = "disabled")
	self.popup.entryconfig("最大化", state = "active")
	self.wm_geometry("%dx%d+%d+%d" % (int(self.w), int(self.h), int(self.w_x), int(self.w_y)))
	self._titlemax["command"] = self.maxsize
	self._titlemax["image"] = self._t2_hov_img
	self.o_m = False

def maxsize(self, event = None):
	if event and self.o_m == True:
		self.resizeback()
	else:
		self.popup.entryconfig("还原", state = "active")
		self.popup.entryconfig("最大化", state = "disabled")
		self.w_x, self.w_y = self.winfo_x(), self.winfo_y()
		self.o_m = True
		self._titlemax["image"] = self._t3_hov_img
		self._titlemax["command"] = self.resizeback
		w, h = self.wm_maxsize()
		self.geometry("%dx%d+0+0" % (w, h - 40))
		#self.state("zoomed")

def minsize(self):
	self.overrideredirect(False)
	self.o_flag = False
	self.state("iconic")
	
def check(self):
	if self.state() != "iconic" and self.o_flag == False:
		self.overrideredirect(True)
		self.o_flag = True
		self.addblur()
	self.after(100, self.check)

def exit_on_enter(self, event):
	if not self.o_f:
		self._titleexit["background"] = self.colors["exit_fg"]
		self._titleexit["image"] = self._t0_img
	else:
		pass
		
def exit_on_leave(self, event):
	if not self.o_f:
		self._titleexit["background"] = self.bg
		self._titleexit["image"] = self._t0_hov_img
	else:
		pass
	
def min_on_enter(self, event):
	self._titlemin["image"] = self._t1_img

def min_on_leave(self, event):
	self._titlemin["image"] = self._t1_hov_img

def max_on_enter(self, event):
	if not self.o_m:
		self._titlemax["image"] = self._t2_img
	else:
		self._titlemax["image"] = self._t3_img

def max_on_leave(self, event):
	if not self.o_m:
		self._titlemax["image"] = self._t2_hov_img
	else:
		self._titlemax["image"] = self._t3_hov_img

# Rewrite
def title(self, text):
	self._titletext["text"] = text

def iconbitmap(self, photo):
	self._icon = Image.open(photo)
	self._icon = self._icon.resize((16, 16)) 
	self._img = ImageTk.PhotoImage(self._icon)
	self._titleicon["image"] = self. _img

def geometry(self, size):
	if self.w and self.h:
		pass
	else:
		self.w, self.h = size.split('x')[0], size.split('x')[1]
	self.wm_geometry(size) ``` ### 感谢看完这篇文档
</code></pre></div></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
